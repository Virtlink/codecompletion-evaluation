Mod(Let([TypeDecs([TypeDec("any",RecordTy([Field("any","int")]))]),VarDecNoType("buffer",Call("getchar",[])),FunDecs([FunDec("readint",[FArg("any",Tid("any"))],Tid("int"),Let([VarDecNoType("i",Int("0")),FunDecs([FunDec("isdigit",[FArg("s",Tid("string"))],Tid("int"),And(Geq(Call("ord",[LValue2Exp(Var2LValue(Var("buffer")))]),Call("ord",[String("\"0\"")])),Leq(Call("ord",[LValue2Exp(Var2LValue(Var("buffer")))]),Call("ord",[String("\"9\"")])))),ProcDec("skipto",[],While(Or(Eq(LValue2Exp(Var2LValue(Var("buffer"))),String("\" \"")),Eq(LValue2Exp(Var2LValue(Var("buffer"))),String("\"\\n\""))),Assign(Var2LValue(Var("buffer")),Call("getchar",[]))))])],[Call("skipto",[]),Assign(FieldVar(Var2LValue(Var("any")),"any"),Call("isdigit",[LValue2Exp(Var2LValue(Var("buffer")))])),While(Call("isdigit",[LValue2Exp(Var2LValue(Var("buffer")))]),Seq([Assign(Var2LValue(Var("i")),Minus(Plus(Times(LValue2Exp(Var2LValue(Var("i"))),Int("10")),Call("ord",[LValue2Exp(Var2LValue(Var("buffer")))])),Call("ord",[String("\"0\"")]))),Assign(Var2LValue(Var("buffer")),Call("getchar",[]))])),LValue2Exp(Var2LValue(Var("i")))]))]),TypeDecs([TypeDec("list",RecordTy([Field("first","int"),Field("rest","list")]))]),FunDecs([FunDec("readlist",[],Tid("list"),Let([VarDecNoType("any",Record("any",[InitField("any",Int("0"))])),VarDecNoType("i",Call("readint",[LValue2Exp(Var2LValue(Var("any")))]))],[If(LValue2Exp(FieldVar(Var2LValue(Var("any")),"any")),Record("list",[InitField("first",LValue2Exp(Var2LValue(Var("i")))),InitField("rest",Call("readlist",[]))]),NilExp())])),FunDec("merge",[FArg("a",Tid("list")),FArg("b",Tid("list"))],Tid("list"),If(Eq(LValue2Exp(Var2LValue(Var("a"))),NilExp()),LValue2Exp(Var2LValue(Var("b"))),If(Eq(LValue2Exp(Var2LValue(Var("b"))),NilExp()),LValue2Exp(Var2LValue(Var("a"))),If(Lt(LValue2Exp(FieldVar(Var2LValue(Var("a")),"first")),LValue2Exp(FieldVar(Var2LValue(Var("b")),"first"))),Record("list",[InitField("first",LValue2Exp(FieldVar(Var2LValue(Var("a")),"first"))),InitField("rest",Call("merge",[LValue2Exp(FieldVar(Var2LValue(Var("a")),"rest")),LValue2Exp(Var2LValue(Var("b")))]))]),Record("list",[InitField("first",LValue2Exp(FieldVar(Var2LValue(Var("b")),"first"))),InitField("rest",Call("merge",[LValue2Exp(Var2LValue(Var("a"))),LValue2Exp(FieldVar(Var2LValue(Var("b")),"rest"))]))]))))),ProcDec("printint",[FArg("i",Tid("int"))],Let([FunDecs([ProcDec("f",[FArg("i",Tid("int"))],IfThen(Gt(LValue2Exp(Var2LValue(Var("i"))),Int("0")),Seq([Call("f",[Divide(LValue2Exp(Var2LValue(Var("i"))),Int("10"))]),Call("print",[Call("chr",[Plus(Minus(LValue2Exp(Var2LValue(Var("i"))),Times(Divide(LValue2Exp(Var2LValue(Var("i"))),Int("10")),Int("10"))),Call("ord",[String("\"0\"")]))])])])))])],[If(Lt(LValue2Exp(Var2LValue(Var("i"))),Int("0")),Seq([Call("print",[String("\"-\"")]),Call("f",[Uminus(LValue2Exp(Var2LValue(Var("i"))))])]),If(Gt(LValue2Exp(Var2LValue(Var("i"))),Int("0")),Call(X-Plhdr(),[LValue2Exp(Var2LValue(Var("i")))]),Call("print",[String("\"0\"")])))])),ProcDec("printlist",[FArg("l",Tid("list"))],If(Eq(LValue2Exp(Var2LValue(Var("l"))),NilExp()),Call("print",[String("\"\\n\"")]),Seq([Call("printint",[LValue2Exp(FieldVar(Var2LValue(Var("l")),"first"))]),Call("print",[String("\" \"")]),Call("printlist",[LValue2Exp(FieldVar(Var2LValue(Var("l")),"rest"))])])))]),VarDecNoType("list1",Call("readlist",[])),VarDecNoType("list2",Seq([Assign(Var2LValue(Var("buffer")),Call("getchar",[])),Call("readlist",[])]))],[Call("printlist",[Call("merge",[LValue2Exp(Var2LValue(Var("list1"))),LValue2Exp(Var2LValue(Var("list2")))])])]))