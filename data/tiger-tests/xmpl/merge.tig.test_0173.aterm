Mod(Let([TypeDecs([TypeDec("any",RecordTy([Field("any","int")]))]),VarDecNoType("buffer",Call("getchar",[])),FunDecs([FunDec("readint",[FArg("any",Tid("any"))],Tid("int"),Let([VarDecNoType("i",Int("0")),FunDecs([FunDec("isdigit",[FArg("s",Tid("string"))],Tid("int"),And(Geq(Call("ord",[LValue2Exp(Var2LValue(Var("buffer")))]),Call("ord",[String("\"0\"")])),Leq(Call("ord",[LValue2Exp(Var2LValue(Var("buffer")))]),Call("ord",[String("\"9\"")])))),ProcDec("skipto",[],While(Or(Eq(LValue2Exp(Var2LValue(Var("buffer"))),String("\" \"")),Eq(LValue2Exp(Var2LValue(Var("buffer"))),String("\"\\n\""))),Assign(Var2LValue(Var("buffer")),Call("getchar",[]))))])],[Call("skipto",[]),Assign(FieldVar(Var2LValue(Var("any")),"any"),Call("isdigit",[LValue2Exp(Var2LValue(Var("buffer")))])),While(Call("isdigit",[LValue2Exp(Var2LValue(Var("buffer")))]),Seq([Assign(Var2LValue(Var("i")),Minus(Plus(Times(LValue2Exp(Var2LValue(Var("i"))),Int("10")),Call("ord",[LValue2Exp(Var2LValue(Var("buffer")))])),Call("ord",[String("\"0\"")]))),Assign(Var2LValue(Var("buffer")),Call("getchar",[]))])),LValue2Exp(Var2LValue(Var("i")))]))]),TypeDecs([TypeDec("list",RecordTy([Field("first","int"),Field("rest","list")]))]),X-Plhdr(),VarDecNoType("list1",Call("readlist",[])),VarDecNoType("list2",Seq([Assign(Var2LValue(Var("buffer")),Call("getchar",[])),Call("readlist",[])]))],[Call("printlist",[Call("merge",[LValue2Exp(Var2LValue(Var("list1"))),LValue2Exp(Var2LValue(Var("list2")))])])]))