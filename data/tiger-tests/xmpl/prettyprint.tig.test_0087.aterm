Mod(Let([TypeDecs([TypeDec("tree",RecordTy([Field("key","string"),Field("left","tree"),Field("right","tree")]))]),FunDecs([FunDec("prettyprint",[FArg("tree",Tid("tree"))],Tid("string"),Let([VarDecNoType("output",String("\"\"")),FunDecs([ProcDec("write",[FArg("s",Tid("string"))],Assign(Var2LValue(Var("output")),Call("concat",[LValue2Exp(Var2LValue(Var("output"))),LValue2Exp(Var2LValue(Var("s")))]))),ProcDec("show",[FArg("n",Tid("int")),FArg("t",Tid("tree"))],Let([FunDecs([ProcDec("indent",[FArg("s",Tid("string"))],Seq([Call("write",[String(X-Plhdr())]),For(Var("i"),Int("1"),LValue2Exp(Var2LValue(Var("n"))),Call("write",[String("\" \"")])),Assign(Var2LValue(Var("output")),Call("concat",[LValue2Exp(Var2LValue(Var("output"))),LValue2Exp(Var2LValue(Var("s")))]))]))])],[If(Eq(LValue2Exp(Var2LValue(Var("t"))),NilExp()),Call("indent",[String("\".\"")]),Seq([Call("indent",[LValue2Exp(FieldVar(Var2LValue(Var("t")),"key"))]),Call("show",[Plus(LValue2Exp(Var2LValue(Var("n"))),Int("1")),LValue2Exp(FieldVar(Var2LValue(Var("t")),"left"))]),Call("show",[Plus(LValue2Exp(Var2LValue(Var("n"))),Int("1")),LValue2Exp(FieldVar(Var2LValue(Var("t")),"right"))])]))]))])],[Call("show",[Int("0"),LValue2Exp(Var2LValue(Var("tree")))]),LValue2Exp(Var2LValue(Var("output")))])),FunDec("node",[FArg("x",Tid("string")),FArg("l",Tid("tree")),FArg("r",Tid("tree"))],Tid("tree"),Record("tree",[InitField("key",LValue2Exp(Var2LValue(Var("x")))),InitField("left",LValue2Exp(Var2LValue(Var("l")))),InitField("right",LValue2Exp(Var2LValue(Var("r"))))])),ProcDec("printnl",[FArg("x",Tid("string"))],Seq([Call("print",[LValue2Exp(Var2LValue(Var("x")))]),Call("print",[String("\"\\n\"")])]))])],[Let([VarDec("t",Tid("tree"),Call("node",[String("\"a\""),Call("node",[String("\"b\""),NilExp(),NilExp()]),Call("node",[String("\"c\""),NilExp(),Call("node",[String("\"d\""),NilExp(),NilExp()])])]))],[Call("prettyprint",[LValue2Exp(Var2LValue(Var("t")))])])]))