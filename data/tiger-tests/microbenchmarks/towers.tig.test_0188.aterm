Mod(For(Var("i"),Int("0"),Int("30"),Seq([Call("timeGo",[]),Let([TypeDecs([TypeDec("TowersDisk",RecordTy([Field("size","int"),Field("next","TowersDisk")])),TypeDec("arrayOfTowersDisk",ArrayTy("TowersDisk"))]),VarDec("piles",Tid("arrayOfTowersDisk"),Array("arrayOfTowersDisk",Int("3"),NilExp())),VarDec("movesDone",Tid("int"),Int("0")),FunDecs([ProcDec("pushDisk",[FArg("disk",Tid("TowersDisk")),FArg("pile",Tid("int"))],Let([VarDec("top",Tid("TowersDisk"),LValue2Exp(Subscript(Var2LValue(Var("piles")),LValue2Exp(Var2LValue(Var("pile"))))))],[Assign(FieldVar(Var2LValue(Var("disk")),"next"),LValue2Exp(Var2LValue(Var("top")))),Assign(Subscript(Var2LValue(Var("piles")),LValue2Exp(Var2LValue(Var("pile")))),LValue2Exp(Var2LValue(Var("disk"))))])),FunDec("popDiskFrom",[FArg("pile",Tid("int"))],Tid("TowersDisk"),Let([VarDec("top",Tid("TowersDisk"),LValue2Exp(Subscript(Var2LValue(Var("piles")),LValue2Exp(Var2LValue(Var("pile"))))))],[Assign(Subscript(Var2LValue(Var("piles")),LValue2Exp(Var2LValue(Var("pile")))),LValue2Exp(FieldVar(Var2LValue(Var("top")),"next"))),Assign(FieldVar(Var2LValue(Var("top")),"next"),NilExp()),LValue2Exp(Var2LValue(Var("top")))])),ProcDec("moveTopDisk",[FArg("fromPile",Tid("int")),FArg("toPile",Tid("int"))],Seq([Call("pushDisk",[Call("popDiskFrom",[LValue2Exp(Var2LValue(Var("fromPile")))]),LValue2Exp(Var2LValue(Var("toPile")))]),Assign(Var2LValue(Var("movesDone")),Plus(LValue2Exp(Var2LValue(Var("movesDone"))),Int("1")))])),ProcDec(X-Plhdr(),[FArg("pile",Tid("int")),FArg("disks",Tid("int"))],For(Var("i"),Int("0"),LValue2Exp(Var2LValue(Var("disks"))),Call("pushDisk",[Record("TowersDisk",[InitField("size",LValue2Exp(Var2LValue(Var("i")))),InitField("next",NilExp())]),LValue2Exp(Var2LValue(Var("pile")))]))),ProcDec("moveDisks",[FArg("disks",Tid("int")),FArg("fromPile",Tid("int")),FArg("toPile",Tid("int"))],If(Eq(LValue2Exp(Var2LValue(Var("disks"))),Int("1")),Call("moveTopDisk",[LValue2Exp(Var2LValue(Var("fromPile"))),LValue2Exp(Var2LValue(Var("toPile")))]),Let([VarDec("otherPile",Tid("int"),Minus(Seq([Minus(Int("3"),LValue2Exp(Var2LValue(Var("fromPile"))))]),LValue2Exp(Var2LValue(Var("toPile")))))],[Call("moveDisks",[Minus(LValue2Exp(Var2LValue(Var("disks"))),Int("1")),LValue2Exp(Var2LValue(Var("fromPile"))),LValue2Exp(Var2LValue(Var("otherPile")))]),Call("moveTopDisk",[LValue2Exp(Var2LValue(Var("fromPile"))),LValue2Exp(Var2LValue(Var("toPile")))]),Call("moveDisks",[Minus(LValue2Exp(Var2LValue(Var("disks"))),Int("1")),LValue2Exp(Var2LValue(Var("otherPile"))),LValue2Exp(Var2LValue(Var("toPile")))])])))])],[Call("buildTowerAt",[Int("0"),Int("13")]),Assign(Var2LValue(Var("movesDone")),Int("0")),Call("moveDisks",[Int("13"),Int("0"),Int("1")]),LValue2Exp(Var2LValue(Var("movesDone")))]),Call("timeStop",[])])))