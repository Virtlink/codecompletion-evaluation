Mod(Let([TypeDecs([TypeDec("vec",ArrayTy("int")),TypeDec("vector",RecordTy([Field("dim","int"),Field("d","vec")])),TypeDec("mat",ArrayTy("vector")),TypeDec("matrix",RecordTy([Field("x","int"),Field("y","int"),Field("d","mat")]))]),FunDecs([FunDec("vectorCreate",[FArg("n",Tid("int"))],Tid("vector"),Record("vector",[InitField("dim",LValue2Exp(Var2LValue(Var("n")))),InitField("d",Array("vec",LValue2Exp(Var2LValue(Var("n"))),Int("0")))])),FunDec("vectorLiftedAdd",[FArg("X",Tid("vector")),FArg("Y",Tid("vector"))],Tid("vector"),Let([VarDec("tmp",Tid("vector"),Call("vectorCreate",[LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim"))]))],[For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim")),Assign(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("i")))),Plus(LValue2Exp(Subscript(FieldVar(Var2LValue(Var("X")),"d"),LValue2Exp(Var2LValue(Var("i"))))),LValue2Exp(Subscript(FieldVar(Var2LValue(Var("Y")),"d"),LValue2Exp(Var2LValue(Var("i")))))))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("vectorLiftedMul",[FArg("X",Tid("vector")),FArg("Y",Tid("vector"))],Tid("vector"),Let([VarDec("tmp",Tid("vector"),Call("vectorCreate",[LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim"))]))],[For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim")),Assign(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("i")))),Times(LValue2Exp(Subscript(FieldVar(Var2LValue(Var("X")),"d"),LValue2Exp(Var2LValue(Var("i"))))),LValue2Exp(Subscript(FieldVar(Var2LValue(Var("Y")),"d"),LValue2Exp(Var2LValue(Var("i")))))))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("vectorInProduct",[FArg("X",Tid("vector")),FArg("Y",Tid("vector"))],Tid("int"),Let([VarDec("tmp",Tid("int"),Int("0"))],[For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim")),Assign(Var2LValue(Var("tmp")),Plus(LValue2Exp(Var2LValue(Var("tmp"))),Times(LValue2Exp(Subscript(FieldVar(Var2LValue(Var("X")),"d"),LValue2Exp(Var2LValue(Var("i"))))),LValue2Exp(Subscript(FieldVar(Var2LValue(Var("Y")),"d"),LValue2Exp(Var2LValue(Var("i"))))))))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("matrixCreate",[FArg("n",Tid("int")),FArg("m",Tid("int"))],Tid("matrix"),Let([VarDecNoType("tmp",Record("matrix",[InitField("x",LValue2Exp(Var2LValue(Var("n")))),InitField("y",LValue2Exp(Var2LValue(Var("m")))),InitField("d",Array("mat",LValue2Exp(Var2LValue(Var("n"))),NilExp()))]))],[For(Var("i"),Int("0"),LValue2Exp(Var2LValue(Var("n"))),Assign(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("i")))),Call("vectorCreate",[LValue2Exp(Var2LValue(Var("m")))]))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("matrixRow",[FArg("A",Tid("matrix")),FArg("i",Tid("int"))],Tid("vector"),LValue2Exp(Subscript(FieldVar(Var2LValue(Var("A")),"d"),LValue2Exp(Var2LValue(Var("i")))))),FunDec("matrixCol",[FArg("A",Tid("matrix")),FArg("j",Tid("int"))],Tid("vector"),Let([VarDecNoType("tmp",Call("vectorCreate",[LValue2Exp(FieldVar(Var2LValue(Var("A")),"y"))]))],[For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),Assign(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("i")))),LValue2Exp(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("A")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("j"))))))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("matrixTranspose",[FArg("A",Tid("matrix"))],Tid("matrix"),Let([VarDecNoType("tmp",Call("matrixCreate",[LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),LValue2Exp(FieldVar(Var2LValue(Var("A")),"x"))]))],[For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),For(Var("j"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),Assign(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("j")))),"d"),LValue2Exp(Var2LValue(Var("i")))),LValue2Exp(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("A")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("j")))))))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("matrixLiftedAdd",[FArg("A",Tid("matrix")),FArg("B",Tid("matrix"))],Tid("matrix"),Let([VarDecNoType("tmp",Call("matrixCreate",[LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),LValue2Exp(FieldVar(Var2LValue(Var("A")),"y"))]))],[If(Or(Neq(LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),LValue2Exp(FieldVar(Var2LValue(Var("B")),"x"))),Neq(LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),LValue2Exp(FieldVar(Var2LValue(Var("B")),"y")))),Call("exit",[Int("1")]),For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),For(Var("j"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),X-Plhdr()))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("matrixLiftedMul",[FArg("A",Tid("matrix")),FArg("B",Tid("matrix"))],Tid("matrix"),Let([VarDecNoType("tmp",Call("matrixCreate",[LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),LValue2Exp(FieldVar(Var2LValue(Var("A")),"y"))]))],[If(Or(Neq(LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),LValue2Exp(FieldVar(Var2LValue(Var("B")),"x"))),Neq(LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),LValue2Exp(FieldVar(Var2LValue(Var("B")),"y")))),Call("exit",[Int("1")]),For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),For(Var("j"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),Assign(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("j")))),Times(LValue2Exp(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("A")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("j"))))),LValue2Exp(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("B")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("j")))))))))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("matrixMul",[FArg("A",Tid("matrix")),FArg("B",Tid("matrix"))],Tid("matrix"),Let([VarDecNoType("tmp",Call("matrixCreate",[LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),LValue2Exp(FieldVar(Var2LValue(Var("B")),"y"))]))],[If(Neq(LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),LValue2Exp(FieldVar(Var2LValue(Var("B")),"x"))),Call("exit",[Int("1")]),For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),For(Var("j"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("B")),"y")),Assign(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("j")))),Call("vectorInProduct",[Call("matrixRow",[LValue2Exp(Var2LValue(Var("A"))),LValue2Exp(Var2LValue(Var("i")))]),Call("matrixCol",[LValue2Exp(Var2LValue(Var("B"))),LValue2Exp(Var2LValue(Var("j")))])]))))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("createDiagMat",[FArg("X",Tid("vector"))],Tid("matrix"),Let([VarDecNoType("tmp",Call("matrixCreate",[LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim")),LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim"))]))],[For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim")),Assign(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("i")))),LValue2Exp(Subscript(FieldVar(Var2LValue(Var("X")),"d"),LValue2Exp(Var2LValue(Var("i"))))))),LValue2Exp(Var2LValue(Var("tmp")))])),FunDec("matrixMulDiag",[FArg("A",Tid("matrix")),FArg("X",Tid("vector"))],Tid("matrix"),Let([VarDecNoType("tmp",Call("matrixCreate",[LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),LValue2Exp(FieldVar(Var2LValue(Var("A")),"y"))]))],[If(Neq(LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),LValue2Exp(FieldVar(Var2LValue(Var("X")),"dim"))),Call("exit",[Int("1")]),For(Var("i"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"x")),For(Var("j"),Int("0"),LValue2Exp(FieldVar(Var2LValue(Var("A")),"y")),Assign(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("tmp")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("j")))),Times(LValue2Exp(Subscript(FieldVar(Subscript(FieldVar(Var2LValue(Var("A")),"d"),LValue2Exp(Var2LValue(Var("i")))),"d"),LValue2Exp(Var2LValue(Var("j"))))),LValue2Exp(Subscript(FieldVar(Var2LValue(Var("X")),"d"),LValue2Exp(Var2LValue(Var("j")))))))))),LValue2Exp(Var2LValue(Var("tmp")))]))])],[Call("matrixMul",[LValue2Exp(Var2LValue(Var("A"))),Call("createDiagMat",[LValue2Exp(Var2LValue(Var("X")))])])]))